<!DOCTYPE html>
<html>
  <head>
    <title>Analyzing an experiment on   involuntary attention using brms</title>
    <meta charset="utf-8">
    <meta name="author" content="Antonio Schettino    Department of Experimental-Clinical &amp; Health Psychology  Ghent University" />
    <link rel="stylesheet" href="default.css" type="text/css" />
    <link rel="stylesheet" href="Schettino_UGent_CSS.css" type="text/css" />
    <link rel="stylesheet" href="Schettino_UGent-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Analyzing an experiment on <br /> involuntary attention using <strong><code>brms</code></strong>
### Antonio Schettino<br /> <br /> Department of Experimental-Clinical &amp; Health Psychology<br /> Ghent University

---




layout: true

&lt;!-- set header --&gt;
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;!-- set footer --&gt;
&lt;div class="my-footer"&gt;&lt;span&gt;Antonio Schettino   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
Bayes@Lund - 12.04.2018&lt;/span&gt;&lt;/div&gt;

&lt;!-- ################################### --&gt;
&lt;!-- ############# OUTLINE ############# --&gt;
&lt;!-- ################################### --&gt;

---
name: outline

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.left[
  .font200[
    **OUTLINE**
  ]
]

&lt;br /&gt;

.font120[
  * background
]

.font120[
  * experimental paradigm
]

.font120[
  * data and results
]

.font120[
  * conclusions
]

--
&lt;!-- add collaborators picture --&gt;
&lt;Div style="margin-top:-380px" /&gt;

.right[
  ![collaborators](collaborators.jpg)
]

&lt;!-- ################################### --&gt;
&lt;!-- ############ BACKGROUND ########### --&gt;
&lt;!-- ################################### --&gt;

---
name: notification_trolling

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Involuntary attention**
  ]
]

&lt;br /&gt;

&lt;!-- add video --&gt;
.center[
  &lt;body&gt;
  &lt;video width="320" height="240" controls="controls" vid.autoplay="false"&gt;
  &lt;source src="notification_troll.mp4" type="video/mp4"&gt;
  &lt;object data="" width="320" height="240"&gt;
  &lt;embed width="320" height="240" src="notification_troll.mp4"&gt;
  &lt;/object&gt;&lt;/video&gt;&lt;/body&gt;
  &lt;br /&gt;&lt;br /&gt;
  source: https://www.youtube.com/watch?v=0M2L9XNYfLs
]

---
name: clarify_example1

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**What happened?**
  ]
]

--

.font120[
  * The guy in the background was attracted to the phone...
]

--

.font120[
  * ... despite *knowing* that his friend was making the notification sounds
]

--

.font120[
  * His attention was **automatically** attracted to ~~uninformative~~ **counterproductive** sounds (distraction from current task: watching TV)
]

---
name: clarify_example2

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Why study involuntary attention?**
  ]
]

--

.font120[
  * Involuntary attentional orienting can be dangerous in some real-life situations
]

--

.font120[
  *  Car driver distracted by flashing mobile phone, worker operating heavy machinery distracted by blinking lights, ...
]

--

.font120[
  * How to study this phenomenon in the lab?
]

&lt;!-- ################################### --&gt;
&lt;!-- ###### EXPERIMENTAL PARADIGM ###### --&gt;
&lt;!-- ################################### --&gt;
---
name: TOJ

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Temporal Order Judgment (TOJ)**
  ]
]

--

.font120[
  * Flash two stimuli on screen
]

--

.font120[
  * Task: which stimulus appeared **first**?
]

--

.font120[
  * Difficulty depends on the time between the onset of the stimuli (**SOA**)
]

---
name: TOJ_example
background-image: url("TOJ_video.gif")
background-size: 700px
background-position: 50% 65%

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Temporal Order Judgment (TOJ)**
  ]
]

---
name: TOJ_cue

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Counterproductive TOJ**
  ]
]

.font120[
  * An **exogenous cue** is used to attract attention towards one placeholder
]

--

.font120[
  * The stimulus on the attended location is perceived as **first** even when appearing second
]

--

.font120[
  * What if the cue is **always wrong**, i.e., appearing on the location of the *second* stimulus?
]

---
name: TOJ_video_cue
background-image: url("TOJ_video_cue.gif")
background-size: 700px
background-position: 50% 80%

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Counterproductive TOJ**
  ]
]

&lt;!-- ################################### --&gt;
&lt;!-- ########## DATA &amp; RESULTS ######### --&gt;
&lt;!-- ################################### --&gt;

---
name: TOJ_data

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**TOJ - Data**
  ]
]


```
## # A tibble: 14,141 x 4
##    participant SOA   cue             response
##    &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;              &lt;int&gt;
##  1 1           +150  no.cue                 2
##  2 1           +83   no.cue                 2
##  3 1           +217  no.cue                 2
##  4 1           -83   horizontal.cued        8
##  5 1           -217  no.cue                 8
##  6 1           -150  no.cue                 8
##  7 1           +150  vertical.cued          2
##  8 1           -83   horizontal.cued        2
##  9 1           -150  no.cue                 8
## 10 1           +150  no.cue                 2
## # ... with 14,131 more rows
```

&lt;Div style="margin-top:-350px" /&gt;

--

.right[
  .font120[31 participants
  ]
]

--

.right[
  .font120[5 SOAs
  ]
]

--

.right[
  .font120[3 cue conditions
  ]
]

--

.right[
  .font120[*"2"*: horizontal first
  ]
]

--

.right[
  .font120[*"8"*: vertical first
  ]
]

---
name: TOJ_graph

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**TOJ - Plot**
  ]
]

&lt;Div style="margin-top:-40px" /&gt;

.center[
![](Schettino_BayesAtLund2018_files/figure-html/TOJ_exp1-1.svg)&lt;!-- --&gt;
]

&lt;!-- Incremental lists do not give me what I want (due to changes in font formatting and large spacing), --&gt;
&lt;!-- so I created new slides and duplicated the content. Not elegant, but effective. --&gt;
---
name: TOJ_analysis_desc1

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

---
name: TOJ_analysis_desc2

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
]

---
name: TOJ_analysis_desc3

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
]

---
name: TOJ_analysis_desc4

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
]

---
name: TOJ_analysis_desc5

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
]

---
name: TOJ_analysis_desc6

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
]

---
name: TOJ_analysis_desc7

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
]

---
name: TOJ_analysis_desc8

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
]

---
name: TOJ_analysis_desc9

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
  4. main effect of **cue**
]

---
name: TOJ_analysis_desc10

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
  4. main effect of **cue**
  5. **null** model (intercept only)
]

---
name: TOJ_analysis_desc11

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
  4. main effect of **cue**
  5. **null** model (intercept only)
* on the winning model:
]

---
name: TOJ_analysis_desc12

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
  4. main effect of **cue**
  5. **null** model (intercept only)
* on the winning model:
  - diagnostics &amp; posterior predictive checks
]

---
name: TOJ_analysis_desc13

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling**
  ]
]

.font120[
* multilevel logistic regression
* random intercepts and slopes on *participants*
* **highly informative priors** (from a pilot study)
* model comparison:
  1. full model (**SOA** x **cue**)
  2. main effects (**SOA** + **cue**)
  3. main effect of **SOA**
  4. main effect of **cue**
  5. **null** model (intercept only)
* on the winning model:
  - diagnostics &amp; posterior predictive checks
  - hypothesis testing
]

&lt;!-- ###################################### --&gt;
&lt;!-- Example of model specification in brms --&gt;
&lt;!-- ###################################### --&gt;
---
name: TOJ_analysis_model

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant), 
              data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight1

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- Dependent variable: number of trials in which participants responded "horizontal first" over all trials. --&gt;
&lt;!-- Population-level (= fixed) effects: one column with all condition combinations. --&gt;
```r
##################### full model (SOA * cue) #####################
*   model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight2

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- Group-level (= random) effects: allow intercepts and slopes to vary across participants. --&gt;
&lt;!-- What does it **practically** mean? For example: --&gt;
&lt;!-- - participant 1 could overall be slower than participant 2; or --&gt;
&lt;!-- - participant 17 could be faster at SOA 217 but slower at SOA150 compared to participant 19; --&gt;
&lt;!-- - ... you get the idea. --&gt;
&lt;!-- Here, || is used to prevent group-level correlations from being modeled. --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
*                (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight3

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- The data. --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
*                data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight4

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- The likelihood function. --&gt;
&lt;!-- The data are a bunch of 0s and 1s (the participant did/didn't respond "horizontal first"), hence the binomial distribution. --&gt;
&lt;!-- Why 'logit' link? coefficients can be interpreted in terms of odds ratios. --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
              data=data.TOJ,
*                family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight5

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- Priors.full indicates a list with highly informative priors. --&gt;
&lt;!-- We ran a pilot study identical to this one, fitted this same model (with default priors), --&gt;
&lt;!-- and used the **posterior** distributions of those parameters as **priors** for this model. --&gt;
&lt;!-- In brms, use the function 'set_prior'. --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
*                prior=priors.full,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight6

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- Extract samples from the priors, they will be useful later on. --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
*                sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_analysis_model_highlight7

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- These settings refer to the No-U-Turn-Sampler (NUTS) in STAN: --&gt;
&lt;!-- - inits: initial parameter values in the Markov-Chain Monte Carlo (MCMC) chains; --&gt;
&lt;!-- - control: steps of the NUTS sampler; --&gt;
&lt;!-- - chains: number of MCMC chains; --&gt;
&lt;!-- - iter: number of iterations for each MCMC chain; --&gt;
&lt;!-- - warmup: number of burn-in samples; --&gt;
&lt;!-- - thin: thinning rate; --&gt;
&lt;!-- - algorithm: type of sampling algorithm; --&gt;
&lt;!-- - cores: numer of processor cores for parallel computations; --&gt;
&lt;!-- - seed: seed for RNG (to ensure reproducible results). --&gt;
&lt;!-- For details, see help(brm). --&gt;
```r
##################### full model (SOA * cue) #####################
model.full &lt;- brm(num.horiz1st | trials(tot.trials) ~ conditions +
              (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
              prior=priors.full,
              sample_prior=TRUE,
*                inits="random",
*                control=list(adapt_delta=.9),
*                chains=4,
*                iter=2000,
*                warmup=500,
*                thin=1,
*                algorithm="sampling",
*                cores=4,
*                seed=9001)
```

---
name: TOJ_analysis_model_highlight8

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Bayesian multilevel modeling with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

&lt;!-- To specify the other models, change the name of the independent variable --&gt;
&lt;!-- and set the priors of the appropriate model. --&gt;
```r
##################### main effect of SOA #####################
*   model.SOA &lt;- brm(num.horiz1st | trials(tot.trials) ~ SOA +
              (conditions || participant),
              data=data.TOJ,
              family=binomial("logit"),
*                 prior=priors.SOA,
              sample_prior=TRUE,
              inits="random",
              control=list(adapt_delta=.9),
              chains=4,
              iter=2000,
              warmup=500,
              thin=1,
              algorithm="sampling",
              cores=4,
              seed=9001)
```

---
name: TOJ_LOO

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Model comparison with ```brms```**
  ]
]

&lt;Div style="margin-top:-30px" /&gt;

.center[
  .font130[(*leave-one-out* cross-validation)
  ]
]

```r
model.comparison &lt;- LOO( # list with all models
                      model.full, model.mains, model.SOA, model.cue, model.null,
                      reloo=TRUE, # exact CV for problematic observations
                      compare=FALSE) # do not compare models with each other
```

.center[
  .font130[
  
  ```
  ##   models  LOO.IC
  ## 1  mains 2727.31
  ## 2   full 2844.49
  ## 3    SOA 3628.22
  ## 4    cue 7998.10
  ## 5   null 8275.49
  ```
  ]
]

---
name: TOJ_analysis_output

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**```brms``` output**
  ]
]

&lt;Div style="margin-top:-40px" /&gt;

.center[
  .font130[(**main effects** model, only **"fixed"** effects)
  ]
]

&lt;!-- ################################### --&gt;
&lt;!-- Explain Eff. Sample and Rhat --&gt;
&lt;!-- Check the effective sample size ($\sf{N_{eff}}$), an estimate of the number of independent draws from the posterior distribution of the estimand of interest. Because the draws within a Markov chain are not independent if there is autocorrelation, `\(\sf{N_{eff}}\)` will be smaller than the total sample size ($N$). The larger the ratio `\(\sf{N_{eff}}\)`/$N$, the better the estimation. As a rule of thumb, this ratio can be worrisome if &lt; 0.1. With respect to the fixed effects of this model, the worst ratio is 3422/6000=0.57 (beta for SOA +150).

Check `\(\hat{R}\)`, which measures the ratio of the average variance of samples within each chain to the variance of the pooled samples across chains. If all chains are at equilibrium, these will be the same and `\(\hat{R}\)` will be one. If the chains have not converged to a common distribution, `\(\hat{R}\)` will be greater than one (Stan Development Team, 2016). For this model, `\(\hat{R}\)` is never above 1.05.
 --&gt;


```
##  [1] "Population-Level Effects: "                                             
##  [2] "                   Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat"
##  [3] "Intercept              0.06      0.06    -0.06     0.19       4716 1.00"
##  [4] "SOAM217               -2.64      0.13    -2.89    -2.38       4256 1.00"
##  [5] "SOAM150               -2.23      0.13    -2.50    -1.97       3727 1.00"
##  [6] "SOAM83                -1.53      0.10    -1.73    -1.34       4928 1.00"
##  [7] "SOAM17                -0.35      0.06    -0.47    -0.22       6000 1.00"
##  [8] "SOAP17                 0.21      0.06     0.09     0.33       6000 1.00"
##  [9] "SOAP83                 1.60      0.11     1.39     1.81       4528 1.00"
## [10] "SOAP150                2.42      0.16     2.11     2.72       3422 1.00"
## [11] "SOAP217                2.73      0.16     2.41     3.06       3851 1.00"
## [12] "cuevertical.cued      -0.80      0.06    -0.93    -0.68       6000 1.00"
## [13] "cuehorizontal.cued     0.86      0.07     0.73     1.00       5145 1.00"
```

---
name: TOJ_analysis_MCMCchains

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**MCMC chains**
  ]
]

&lt;br /&gt;
&lt;Div style="margin-left:-50px" /&gt;

.pull-left[
  ```r
  library(bayesplot)
  mcmc_trace(as.array(model.mains),
  pars=c("b_Intercept", 
    "b_cuevertical.cued", 
    "b_cuehorizontal.cued"),
  facet_args=list(ncol=1))
  ```
]

&lt;Div style="margin-right:-40px" /&gt;
&lt;Div style="margin-top:-100px" /&gt; 

.pull-right[
![](Schettino_BayesAtLund2018_files/figure-html/model_mains_MCMC-1.svg)&lt;!-- --&gt;
]

---
name: TOJ_analysis_PPC

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Posterior Predictive Checks**
  ]
]

&lt;br /&gt;
&lt;Div style="margin-left:-50px" /&gt;

.code100[
  .pull-left[
    ```r
    pp_check(model.mains, 
    nsamples=NULL, 
    type="stat_grouped", 
    group="cue")
    ```
  ]
]

&lt;Div style="margin-right:-40px" /&gt;
&lt;Div style="margin-top:-100px" /&gt; 

.pull-right[
![](Schettino_BayesAtLund2018_files/figure-html/model_mains_PPC-1.svg)&lt;!-- --&gt;
]

---
name: TOJ_analysis_predicted_observed

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Observed vs. estimated data**
  ]
]

&lt;Div style="margin-top:-40px" /&gt;

.center[
![](Schettino_BayesAtLund2018_files/figure-html/model_mains_obs_pred-1.svg)&lt;!-- --&gt;
]

---
name: TOJ_analysis_hyptest_nocue_vertcued

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Hypothesis testing**
  ]
]

&lt;Div style="margin-top:-40px" /&gt;

.center[
  .font130[(**no cue** vs. **vertical cued** conditions)
  ]
]



&lt;Div style="margin-left:-40px" /&gt;

.code100[
  .pull-left[
  ```r
  # posterior probability
  # under the hypothesis
  # (no.cue=vertical.cued)
  # against its alternative
  # (no.cue=/=vertical.cued)
  hypothesis(model.mains, 
  "Intercept=Intercept+cuevertical.cued")
  ```
  ]
]

&lt;br /&gt;
&lt;Div style="margin-right:-40px" /&gt;
&lt;Div style="margin-top:-100px" /&gt; 

.pull-right[
![](Schettino_BayesAtLund2018_files/figure-html/model_mains_hyptest_nocue_vertcued_graph-1.svg)&lt;!-- --&gt;
]

---
name: TOJ_analysis_hyptest_nocue_prior_posterior

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Hypothesis testing**
  ]
]

&lt;Div style="margin-top:-40px" /&gt;

.center[
  .font130[(**pilot** vs. **current** experiment)
  ]
]

![](Schettino_BayesAtLund2018_files/figure-html/model_mains_hyptest_prior_vs_post_graph-1.svg)&lt;!-- --&gt;

---
name: conclusions1

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
]

---
name: conclusions2

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
  * SOA and cue influence performance **independently**
    - comparison of *theoretically plausible* multilevel models via loo-cv
]

---
name: conclusions3

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
  * SOA and cue influence performance **independently**
    - comparison of *theoretically plausible* multilevel models via loo-cv
  * the winning model is able to predict unobserved data pretty well
    - *observed* and *estimated* data are very similar
]

---
name: conclusions4

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
  * SOA and cue influence performance **independently**
    - comparison of *theoretically plausible* multilevel models via loo-cv
  * the winning model is able to predict unobserved data pretty well
    - *observed* and *estimated* data are very similar
  * *"horizontal first"* responses are less likely when the *vertical* lines are cued
    - comparison of the posterior distributions of no cue and vertical cued conditions
]

---
name: conclusions5

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
  * SOA and cue influence performance **independently**
    - comparison of *theoretically plausible* multilevel models via loo-cv
  * the winning model is able to predict unobserved data pretty well
    - *observed* and *estimated* data are very similar
  * *"horizontal first"* responses are less likely when the *vertical* lines are cued
    - comparison of the posterior distributions of no cue and vertical cued conditions
  * data of *pilot* and *current* experiment are very similar
    - comparison of prior and posterior distributions of cue conditions
]

---
name: conclusions6

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font200[**Conclusions**
  ]
]

.font110[
  What we have learned:
  * SOA and cue influence performance **independently**
    - comparison of *theoretically plausible* multilevel models via loo-cv
  * the winning model is able to predict unobserved data pretty well
    - *observed* and *estimated* data are very similar
  * *"horizontal first"* responses are less likely when the *vertical* lines are cued
    - comparison of the posterior distributions of no cue and vertical cued conditions
  * data of *pilot* and *current* experiment are very similar
    - comparison of prior and posterior distributions of cue conditions
  * ... and much more! Thanks for ```brms```, @paulbuerkner!
]

---
name: thanks

&lt;!-- set FontAwesome icons --&gt;
&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"&gt;

&lt;Div style="margin-top:90px" /&gt; &lt;!-- start below university header --&gt;

.center[
  .font300[**Thanks for your attention!**]
]

&lt;br /&gt;

.center[
  .font150[
    &lt;a href="mailto:antonio.schettino@ugent.be"&gt; &lt;i class="fa fa-paper-plane fa-fw" style="font-size:30px;color:#152bda;"&gt; &lt;/i&gt;&amp;nbsp; antonio.schettino@ugent.be&lt;/a&gt;&lt;br&gt;
    &lt;a href="https://asch3tti.netlify.com/"&gt;&lt;i class="fa fa-link fa-fw" style="font-size:30px;color:black;"&gt;&lt;/i&gt;&amp;nbsp; asch3tti.netlify.com&lt;/a&gt;&lt;br&gt;
    &lt;a href="https://twitter.com/asch3tti"&gt;&lt;i class="fa fa-twitter fa-fw" style="font-size:35px;color:#00aced;"&gt;&lt;/i&gt;&amp;nbsp; @asch3tti&lt;/a&gt;&lt;br&gt;
&lt;br /&gt;&lt;br /&gt;
Slides available here: https://osf.io/8yzgq/
  ]
]

&lt;!-- ################################### --&gt;
&lt;!-- ############## END ################ --&gt;
&lt;!-- ################################### --&gt;
    </textarea>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"self_contained": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
